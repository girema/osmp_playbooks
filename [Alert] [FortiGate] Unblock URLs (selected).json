{
  "dslSpecVersion": "1.1.0",
  "actionsSpecVersion": "1",
  "inputType": "alert",
  "executionFlow": [
    {
      "action": {
        "filterProduct": {
          "notAllowed": [
            "KATA"
          ]
        },
        "function": {
          "type": "executeCustomScript",
          "params": {
            "commandLine": "python3 /home/admin1/Desktop/XDR/Fortigate/src/main.py ",
            "commandLineParameters": "${delete_web_filter_rule --u=\"\" + ([ .input.observables[] | select(.type == \"url\") | .value ] | join(\", \")) + \"\"}",
            "stdIn": "",
            "workingDirectory": ""
          }
        },
        "output": {
          "filter": "${ . }",
          "action": "overwrite"
        }
      }
    }
  ],
  "name": "Unblock URLS on Fortigate",
  "timeouts": [
    {
      "name": "default",
      "scheduleToCloseTimeout": "20m"
    }
  ],
  "playbookRunTimeout": "30m",
  "version": "1",
  "description": "Playbook to unblock Urls using Fortigate script"
}
