{
  "version": "1",
  "dslSpecVersion": "1.1.0",
  "actionsSpecVersion": "1",
  "executionFlow": [
    {
      "action": {
        "function": {
          "type": "executeCustomScript",
          "params": {
            "commandLine": "bash /root/XDR/ad_user.sh",
            "commandLineParameters": "${\"--action lock --users \" + (alert.Observables | map(select(.Type==\"username\") | .Value | split(\"\\\\\") | .[-1]) | join(\",\"))}",
            "stdIn": "",
            "workingDirectory": ""
          }
        },
        "onError": "continue",
        "timeout": {
          "scheduleToCloseTimeout": "24h"
        }
      }
    },
    {
      "action": {
        "function": {
          "type": "executeCustomScript",
          "params": {
            "commandLine": "bash /root/XDR/ad_user.sh",
            "commandLineParameters": "${\"--action addgroup --users \" + (alert.Observables | map(select(.Type==\"username\") | .Value | split(\"\\\\\") | .[-1]) | join(\",\")) + \" --addgroup \\\"Blocked users\\\"\"}",
            "stdIn": "",
            "workingDirectory": ""
          }
        },
        "onError": "stop",
        "timeout": {
          "scheduleToCloseTimeout": "24h"
        }
      }
    },
    {
      "action": {
        "function": {
          "type": "addCommentToAlert",
          "params": {
            "text": "${\"User account(s) \" + (alert.Observables | map(select(.Type==\"username\") | .Value | split(\"\\\\\") | .[-1]) | join(\", \")) + \" have been locked, added to group \\\"Blocked users\\\", and will be required to change their password at next login.\"}"
          }
        },
        "onError": "stop",
        "timeout": {
          "scheduleToCloseTimeout": "24h"
        }
      }
    }
  ]
}
