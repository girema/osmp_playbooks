{
  "version": "1",
  "dslSpecVersion": "1.1.0",
  "actionsSpecVersion": "1",
  "executionFlow": [
    {
      "action": {
        "function": {
          "type": "executeCustomScript",
          "params": {
            "commandLine": "/root/XDR/get_user_sessions.sh",
            "commandLineParameters": "${\"--action get_process_list --host \" + (alert.Observables | map(select(.Type==\"hostname\") | .Value | split(\"\\\\\") | .[-1]) | join(\",\"))}",
            "stdIn": "",
            "workingDirectory": ""
          }
        },
        "onError": "stop",
        "timeout": {
          "scheduleToCloseTimeout": "24h"
        },
        "output": {
          "filter": "${ {processList: .} }",
          "action": "overwrite"
        }
      }
    },
    {
      "action": {
        "function": {
          "type": "addCommentToAlert",
          "params": {
            "text": "${ \"Process list: \\n\n\" + .processList.details.stdOut }"
          }
        },
        "onError": "stop",
        "timeout": {
          "scheduleToCloseTimeout": "24h"
        }
      }
    }
  ]
}
