{
  "version": "1",
  "dslSpecVersion": "1.1.0",
  "actionsSpecVersion": "1",
  "executionFlow": [
    {
      "action": {
        "function": {
          "type": "executeCustomScript",
          "params": {
            "commandLine": "python3.10 /root/XDR/ad_user.py",
            "commandLineParameters": "${\"--action lock --users '\" + (alert.Observables | map(select(.Type==\"username\") | .Value) | join(\",\")) + \"'\"}",
            "stdIn": "",
            "workingDirectory": ""
          }
        },
        "onError": "continue",
        "timeout": {
          "scheduleToCloseTimeout": "24h"
        }
      }
    },
    {
      "action": {
        "function": {
          "type": "addCommentToAlert",
          "params": {
            "text": "${\"User account(s) \" + (alert.Observables | map(select(.Type==\"username\") | .Value | split(\"\\\\\") | .[-1]) | join(\", \")) + \" have been locked.\"}"
          }
        },
        "onError": "stop",
        "timeout": {
          "scheduleToCloseTimeout": "24h"
        }
      }
    }
  ]
}
