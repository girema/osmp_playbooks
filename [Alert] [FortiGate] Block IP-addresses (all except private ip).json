{
  "dslSpecVersion": "1.1.0",
  "actionsSpecVersion": "1",
  "inputType": "alert",
  "executionFlow": [
    {
      "action": {
        "filterProduct": {
          "notAllowed": [
            "KATA"
          ]
        },
        "function": {
          "type": "executeCustomScript",
          "params": {
            "commandLine": "python3.10 /root/XDR/Playbook/fortinet.py",
            "commandLineParameters": "${add_firewall_rule --ip_address=\"\" + ([ alert.Observables[] | select(.Value | test(\"^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.|127\\\\.)\") | not) | .Value ] | join(\",\")) + \"\"}",
            "stdIn": "",
            "workingDirectory": ""
          }
        },
        "output": {
          "filter": "${ . }",
          "action": "overwrite"
        }
      }
    }
  ],
  "name": "Block ip-addresses on Fortigate",
  "timeouts": [
    {
      "name": "default",
      "scheduleToCloseTimeout": "20m"
    }
  ],
  "playbookRunTimeout": "30m",
  "version": "1",
  "description": "Playbook to block IP addresses using Fortigate script"
}
